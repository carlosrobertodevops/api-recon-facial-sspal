# RECON-FACIAL

> Projeto Criado pelo Sgt PMAC Paes

> Fork criado a partir de Fabio Paes / recon-facial

## 1. API

### 1.1. Mapa da API
```zsh
\api
\api\autenticate.py
\api\recface.py
\api\view.py
```

## 2. Introdução

> Esta API tem três funções principais :

>  Codificar Rosto
  >> application.add_url_rule('/foto/codificar', methods=['POST', 'GET' view_func=codificar_rosto)

>  Comparação entre fotos
  >> application.add_url_rule('/foto/comparar', methods=['POST', 'GET'], view_func=comparar_rosto)

> Teste Estado da api
  >> application.add_url_rule('/', methods=['POST', 'GET'], view_func=index)

### 2.1 Gera suas chaves (keys) pública e privada
```
# GERANDO A CHAVE PUBLICA/PRIVADA - Deixa à senha em branco
ssh-keygen -t rsa -b 4096 -m PEM -f jwtRS256.key

# Gerando o PEM
openssl rsa -in jwtRS256.key -pubout -outform PEM -out jwtRS256.key.pub

# Observar as senha geradas (o usuário pode mudar os nome das chaves para seu cenário especifico)
cat jwtRS256.key        <--- Essa usa para Gerar o Token
cat jwtRS256.key.pub    <--- Essa usa na API para Decodificar o Token
```

### 2.2 Gerar um Token JWT baseado no chave privada (jwtRS256.key)

- Observação O token deve ser criado pela App que vai se conectar a API
- Token JWT deve ser formato por:
```
TOKEN = usuario(nome + iat + exp) + (chave privada + rs256 (algoritmo))
```

### 2.3 Processar o Container da API
```bash
sh deploy.sh
```

### 2.4 Será criado um conteiner com toda infra da API
```
localhost:5002 ou 127.0.0.0:5002

```

## 3. Desenvolvimento
### 3.1 Enviar o Token e as informações de acesso para a API
- API recebe:
```
 POST para API = authorization (token) + origem (chave pública) + algoritmo (rs256)
```

- Dentro do token já esta os dados do usuario conforme tópico 2.2
- Por segurança é bom enviar nome ou cpf do usuario dentro do token

### 3.2
### 3.3
### 3.4
### 3.5
### 3.6 Teste no console (wls2, bash, zsh ou fish)

```
carlosroberto in recon-facial on  main [⇡!]
➜  curl -i -X POST \
-H 'authorization:Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOjE2NzE1MzM4NDcsImV4cCI6MTY3MzIwNTM1NTA0N30.RbFEg9Dgwl7tJ5iArAyEi0ajawkhyn4G6FV1IApYFmHJsbWvUYVmJ5YyUXIOne6VvTwlBmv5KIU1MJYFf4CMpwrJSlQiQsqYy7SqUZ7WOeFpTAWE_48vm7zsdUwnFQ_WQsILaT-uPzjzgSAPXRSq0VdTqROBkDk-2ZnTCz70SHkz5fbLuybXasP-Eu8PP0vXBsgsdwq_CWN5sQcZ-iNjoKJ-7_SoD7uygLwJB0Lho7ycxXd709okbPxckupPb-05_NwcxjjtEmCeZ6GeRxVuskZvqWCwN8ys90hOQOZBX2gBpcEP6zyGHIH0c-VMN71a5QBguppgrqZwLumRmnOfMkcUQsuTTmGyqnZt5tR5UaJ6G1ZmWmpjgLA9pwOxND4lXqlCtCz_xFEWJE33ABVlEP21IAytyypc6OoZcDHTGGqjKbHmCJE9uGuQcuq5kkdh2sogM3_PUzJmFSKtSkHaPk8b41eIopP1Ge2-CndeEhHwNfPXhw9rZayQjUs3Lj6Y7rUjo7nYIzmonN6QlRvlQbwf469LlsE803jQmfBDwMur_6a9vv9COPjEOgnrwaB1CUi4_YZW3QoGBhdefK7hYpAgXeTdBp6FOo_ZZzNu6F9MjfAKD9y7DWiFQmNeSvz-U_TXJnZqA5v-nc9Bytz1SAxwQB2FpM6IgWuWJKR-B2E' \
-H 'forma_processamento:auto' \
-H 'origem:assiifacial' \
-F "upload_image=@/home/carlosroberto/Imagens/3x4x.png" http://127.0.0.1:5002/foto/codificar
HTTP/1.1 100 Continue

HTTP/1.1 200 OK
Server: gunicorn
Date: Tue, 20 Dec 2022 11:09:23 GMT
Connection: keep-alive
Content-Type: text/html; charset=utf-8
Content-Length: 2919

[{"file": "3x4x.png", "mensagem": "", "status": "OK", "metodo": "Autom\u00e1tico!", "encoding": [[-0.08827711641788483, 0.06192152202129364, 0.06614570319652557, -0.06867525726556778, -0.09519809484481812, -0.06951873004436493, 0.01860194280743599, -0.13646382093429565, 0.20231464505195618, -0.20073580741882324, 0.26237112283706665, -0.03837563097476959, -0.2231907844543457, -0.02621062472462654, 0.012677514925599098, 0.13754983246326447, -0.10813823342323303, -0.09814250469207764, -0.08089511096477509, -0.12147817015647888, 0.02409457601606846, 0.015029864385724068, 0.10101966559886932, 0.032646335661411285, -0.13763302564620972, -0.31111419200897217, -0.13023164868354797, -0.06714468449354172, -0.009903513826429844, -0.03377174586057663, 0.06131375953555107, 0.050862815231084824, -0.1646423488855362, 0.005514375865459442, 0.03455467149615288, 0.07119926810264587, -0.08998597413301468, -0.14285126328468323, 0.2629057466983795, -0.022299759089946747, -0.15615449845790863, -0.11749015748500824, 0.050931476056575775, 0.16471877694129944, 0.07962916046380997, 0.00307416170835495, 0.027567772194743156, -0.09279272705316544, 0.1730947047472, -0.204877570271492, 0.04098324105143547, 0.08888944238424301, 0.07372789829969406, 0.05509835481643677, 0.10307908058166504, -0.11257031559944153, 0.08397338539361954, 0.1892678290605545, -0.22802241146564484, 0.0068619707599282265, 0.0328114815056324, -0.07888004183769226, -0.05445363000035286, -0.04727459326386452, 0.27594998478889465, 0.17700745165348053, -0.12730272114276886, -0.07850757986307144, 0.2253807634115219, -0.13154885172843933, -0.014346660114824772, 0.1240667849779129, -0.10186327248811722, -0.21580103039741516, -0.18541152775287628, -0.006526850163936615, 0.4262242615222931, 0.11220666766166687, -0.07579518109560013, -0.04756290465593338, -0.06213265657424927, -0.03241798281669617, 0.05654436722397804, 0.0690348893404007, -0.11750543862581253, -0.0274350568652153, -0.05373823270201683, 0.030467428267002106, 0.25546106696128845, -0.022394848987460136, -0.08749476075172424, 0.2668699026107788, -0.00400596484541893, 0.054475925862789154, 0.005532142706215382, -0.027281636372208595, -0.05780382454395294, -0.004687862936407328, -0.08327590674161911, 0.04141417145729065, 0.033483609557151794, -0.13673348724842072, -0.04325007647275925, 0.051112428307533264, -0.2125217169523239, 0.09999709576368332, -0.01454697921872139, -0.04112699255347252, -0.016135936602950096, -0.0021886855829507113, -0.15793414413928986, -0.01947648823261261, 0.12377367913722992, -0.31938305497169495, 0.1815146803855896, 0.13256078958511353, 0.014909856952726841, 0.19962464272975922, 0.03502378985285759, 0.07031326740980148, 0.03392181545495987, -0.11837509274482727, -0.14736886322498322, -0.08325362950563431, 0.09944692254066467, -0.019073329865932465, 0.07290101796388626, 0.007096000947058201]], "totalrosto": 1, "tempogasto": "0.14214015007019043s"}]%

```




